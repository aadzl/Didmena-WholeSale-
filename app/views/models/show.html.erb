<div class="container">
  <div class='row'>
    <div class="col s12">
      <% if current_user && current_user.apps_manager %>
        <div class="card-action center", style="text-align: left">
          <%= link_to t('edit'), edit_model_path(@model) %> |
          <%= link_to t('back'), models_path %>
        </div>
      <% end %>
    </div>
  </div>
  <div class="row">
    <div class="col s12">
      <% if @model_attachments.any? %>
        <% @model_attachments.each do |p| %>
          <div class="card col s3">
            <div class="card-image">
              <%= image_tag p.avatar_url, :class => "prod_image_small" %>
            </div>
            <% if current_user && current_user.apps_manager %>
              <div class="card-action">
                <%= link_to t('delete'), p, method: :delete, data: { confirm: t('confirm') }, :class => "center-align" %>
              </div>
            <% end %>
          </div>
        <% end %>
      <% else %>
        <img src="http://placehold.it/350x150">
      <% end %>
    </div>
  </div>
  <hr/>
  <div class="row">
    <div class="col s6">     
      <div class="card-content">
        <h5><%= @type %> <%= @collection %></h5>
        <h3><%= @model.title %></h3>
        <h5 style="color: orange"><%= sprintf "%.2f", @model.price %></h5>
        <p><%= @model.note %></p>
        </div>
    </div>
    <div class="col s6">
      <table id="product_table">
        <thead>
          <tr>
            <th></th>
            <th data-field="id"><%= t('models.color') %></th>
              <% @sizes.each do |size| %>
                <th data-field='<%= size.code_value%>' colspan="3" class="center-align"><%= size.code_value%></th>
              <% end %> 
          </tr>
        </thead>
        <tbody id="color_row">
          <% if @products.any? %>
            <% @colors.each do |color| %>
              <tr id='<%= value(color) %>'>
                <td style="background-color: #<%= value(color) %>; width: 5%;"></td>
                <td style="padding-left: 10px; background-color: #<%= value(color) %>;"><%= value(color) %></td>
                <% @sizes.each do |size| %>
                  <% product = find_models_products(color, size) %>
                  <% binding.pry %>
                  <% if product_exist?(color, size) && product_in_storage?(color, size) %>
                      <td class="product_row center-align" colspan="3" >
                        <%= hidden_field_tag "product_id", product.id %>
                        <%= number_field_tag :quantity, params[:quantity], min: 1, class: 'special_input' %>
                      </td>
                    <% else %>
                      <td class="product_row center-align" colspan="3" >
                        <%= hidden_field_tag "product_id", product.id %>
                        <%= number_field_tag :quantity, params[:quantity], min: 1, class: 'special_input', disabled: true %>
                      </td>
                    <% end %>
                  <%end%>
              </tr>
            <% end %>
          <%end%>
        </tbody>
      </table>
      <% if current_user %>
        <button class="btn waves-effect waves-light order_button offset-s2 col s10"><%= t('models.order') %></button>
      <% else %>
        <button class="btn waves-effect waves-light offset-s2 col s10"><%= link_to t('login_not_user'), new_session_path, {:style => 'color: yellow;'} %></button>
      <% end %>

    </div>
  </div>
</div>